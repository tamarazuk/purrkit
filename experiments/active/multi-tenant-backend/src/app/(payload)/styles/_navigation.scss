@import 'mixins';

// Navigation Sidebar Styles
// Based on mockup design with teal active states

.nav {
  width: var(--nav-width);
  background-color: var(--surface-light);
  border-right: 1px solid var(--border-slate-200);
  display: flex;
  flex-direction: column;
  height: 100vh;
  position: relative;
  z-index: 20;

  &__scroll {
    flex: 1;
    overflow-y: auto;
    padding: 1.25rem 1rem 1rem;
  }

  &__wrap {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    min-height: 100%;
  }

  // Navigation links
  &__link {
    @include nav-item-base();
    position: relative;
    border: 1px solid transparent;
    color: var(--text-slate-600);
    text-decoration: none;
    cursor: pointer;

    &:hover {
      background-color: #f8fafc;
      color: var(--text-main);
    }

    // Active state (teal background)
    &[aria-current="page"],
    &--active,
    &:has(.nav__link-indicator) {
      @include nav-active-state();
      border-color: rgba(15, 118, 110, 0.2);
    }

    &-label {
      line-height: 1.5;
    }

    &-indicator {
      // Active indicator (left border)
      position: absolute;
      left: 0.35rem;
      top: 0.45rem;
      bottom: 0.45rem;
      width: 2px;
      background-color: var(--brand-secondary);
      border-radius: 999px;
      opacity: 1;
      transition: opacity var(--transition-base);
    }
  }
}

// Navigation groups (collapsible sections)
.nav-group {
  margin-top: 0.25rem;

  &__toggle {
    @include nav-item-base();
    justify-content: space-between;
    background: none;
    border: 1px solid transparent;
    width: 100%;
    text-align: left;
    cursor: pointer;
    color: var(--text-slate-700);

    &:hover {
      background-color: #f1f5f9;
      color: var(--text-main);
    }

    &--open {
      @include nav-active-state(rgba(15, 118, 110, 0.08));
      border-color: rgba(15, 118, 110, 0.2);

      .nav-group__indicator {
        transform: rotate(180deg);
      }

      .nav-group__label {
        color: var(--brand-secondary);
      }
    }
  }

  &__label {
    font-size: 0.875rem;
    font-weight: 600;
    color: inherit;
    flex: 1;
  }

  &__indicator {
    transition: transform var(--transition-base);
    color: var(--text-slate-500);
    display: flex;
    align-items: center;
    justify-content: center;

    .icon--chevron {
      width: 1rem;
      height: 1rem;
    }

    .icon--chevron .stroke {
      stroke: currentColor;
      fill: none;
      stroke-width: 2px;
    }
  }

  &__content {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
    padding-left: 1.75rem; // Indent nested items
    margin-top: 0.35rem;
    margin-bottom: 0.6rem;
    border-left: 2px solid var(--border-slate-200);
    margin-left: 0.9rem;

    .nav__link {
      @include nav-item-base(0.375rem, 0.75rem, 0.5rem);

      // Active nested link with left border
      &[aria-current="page"],
      &--active {
        border-left: 2px solid var(--brand-secondary);
        margin-left: -2px;
        padding-left: calc(0.75rem - 2px);
      }
    }
  }
}

// Tenant selector styling
.tenant-selector {
  margin-bottom: 0.5rem;

  .field-label {
    color: var(--text-slate-500);
    font-size: 0.75rem;
    font-weight: 600;
    margin-bottom: 0.35rem;
  }

  .rs__control {
    min-height: 2.5rem;
    border-radius: var(--radius-md);
    border-color: var(--border-slate-200);
    background-color: var(--surface-light);
    box-shadow: var(--shadow-sm);
  }

  .rs__placeholder {
    color: var(--text-slate-500);
  }

  .rs__indicator-separator {
    background-color: var(--border-slate-200);
  }
}

// Browse by folder button
.browse-by-folder-button {
  @include nav-item-base(0.5rem, 0.75rem, 0.5rem);
  border: 1px solid transparent;
  color: var(--text-slate-600);
  text-decoration: none;

  .icon,
  svg {
    color: var(--text-slate-400);
  }

  &:hover {
    background-color: #f8fafc;
    color: var(--text-main);
  }
}

// Navigation controls (logout)
.nav__controls {
  margin-top: auto;
  padding-top: 0.75rem;
  border-top: 1px solid var(--border-slate-200);
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
}

.nav__log-out {
  @include nav-item-base(0.5rem, 0.75rem, 0.5rem);
  color: var(--text-slate-600);
  text-decoration: none;
  border: 1px solid transparent;

  &:hover {
    background-color: #f8fafc;
    color: var(--text-main);
  }
}

// User profile section at bottom (if enabled)
.nav__user {
  margin-top: auto;
  padding-top: 1rem;
  border-top: 1px solid var(--border-slate-200);

  &-profile {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.5rem 0.75rem;
  }

  &-avatar {
    width: 2rem;
    height: 2rem;
    border-radius: var(--radius-full);
    background-size: cover;
    background-position: center;
    box-shadow: inset 0 2px 4px 0 rgba(0, 0, 0, 0.06);
  }

  &-info {
    display: flex;
    flex-direction: column;
    overflow: hidden;
    flex: 1;
  }

  &-name {
    font-size: 0.875rem;
    font-weight: 700;
    color: var(--text-main);
    line-height: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  &-email {
    font-size: 0.75rem;
    color: var(--text-slate-500);
    line-height: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
}

// Dark mode navigation
html[data-theme='dark'] {
  .nav {
    background-color: var(--surface-dark);
    border-right-color: var(--border-slate-700);

    &__link {
      color: var(--text-slate-400);

      &:hover {
        background-color: rgba(255, 255, 255, 0.05);
        color: var(--text-main);
      }

      &[aria-current="page"],
      &--active,
      &:has(.nav__link-indicator) {
        background-color: rgba(15, 118, 110, 0.18);
        color: #5eead4; // Teal-300
        border-color: rgba(15, 118, 110, 0.35);
      }
    }
  }

  .nav-group {
    &__toggle {
      color: var(--text-slate-300);

      &:hover {
        background-color: rgba(255, 255, 255, 0.05);
        color: var(--text-main);
      }

      &--open {
        background-color: rgba(15, 118, 110, 0.2);
        border-color: rgba(15, 118, 110, 0.35);
      }
    }

    &__indicator {
      color: var(--text-slate-400);
    }

    &__content {
      border-left-color: var(--border-slate-700);
    }
  }

  .nav__user {
    border-top-color: var(--border-slate-700);
  }

  .tenant-selector {
    .field-label {
      color: var(--text-slate-400);
    }

    .rs__control {
      background-color: var(--surface-dark);
      border-color: var(--border-slate-700);
    }

    .rs__placeholder {
      color: var(--text-slate-400);
    }

    .rs__indicator-separator {
      background-color: var(--border-slate-700);
    }
  }

  .browse-by-folder-button,
  .nav__log-out {
    color: var(--text-slate-400);

    &:hover {
      background-color: rgba(255, 255, 255, 0.05);
      color: var(--text-main);
    }
  }
}
